<template>
    <template if:true={showCard}>
        <lightning-layout multiple-rows="true" class="slds-card slds-box" style="overflow: hidden">
            <!--HEADER-->
            <lightning-layout-item size="12" class="slds-var-p-bottom_medium" style={headerBackground}>
                <lightning-layout vertical-align="center">
                    <template if:true={icon}>
                        <lightning-icon icon-name={icon} size="small"></lightning-icon>
                    </template>
                    <h3 class="slds-p-left_x-small slds-text-heading_small">{cardTitle}</h3>
                </lightning-layout>
            </lightning-layout-item>
            <template if:true={relatedRecords}>
                <div
                    class="slds-grow slds-listbox_vertical slds-card__body"
                    style="margin-top: 0px; margin-bottom: 0px; overflow: hidden"
                >
                    <div class="slds-scrollable_y" style={scrollableStyle}>
                        <div class="slds-table slds-table_cell-buffer">
                            <template for:each={relatedRecords} for:item="record" for:index="rowIndex">
                                <c-crm-related-list-item
                                    key={record.Id}
                                    record={record}
                                    used-fields={usedFields}
                                    related-object-api-name={relatedObjectApiName}
                                    index={rowIndex}
                                    object-name={objectName}
                                    date-field={dateField}
                                ></c-crm-related-list-item>
                            </template>
                        </div>
                    </div>
                </div>
            </template>
        </lightning-layout>
    </template>
</template>
