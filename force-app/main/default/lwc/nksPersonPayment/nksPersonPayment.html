<template>
    <div class="slds-var-m-bottom_x-small payment-tile-bg" aria-expanded={expanded} onclick={toggleExpand}>
        <lightning-layout multiple-rows="true">
            <lightning-layout-item
                size="1"
                padding="horizontal-small"
                class="slds-var-p-left_x-large slds-var-p-top_x-large"
            >
                <lightning-icon data-paid={paid} icon-name={statusIcon} size="medium"> </lightning-icon>
            </lightning-layout-item>
            <lightning-layout-item size="11" class="slds-var-p-left_small">
                <lightning-layout
                    multiple-rows="true"
                    class="slds-var-p-bottom_small slds-var-p-top_small slds-var-p-right_small"
                >
                    <lightning-layout-item size="8" padding="horizontal-small">
                        <h3 class="slds-text-title_bold">{ytelserHeader}</h3>
                    </lightning-layout-item>
                    <lightning-layout-item size="4" padding="horizontal-small">
                        <lightning-layout horizontal-align="end">
                            <b>
                                <lightning-formatted-number
                                    value={payment.utbetalingNettobeloep}
                                    maximum-fraction-digits="2"
                                    minimum-fraction-digits="2"
                                ></lightning-formatted-number>
                            </b>
                        </lightning-layout>
                    </lightning-layout-item>
                    <lightning-layout-item size="8" padding="horizontal-small">
                        <lightning-layout if:true={payment.utbetalingsdato}>
                            <lightning-formatted-date-time
                                value={payment.utbetalingsdato}
                            ></lightning-formatted-date-time>
                            &nbsp;
                            <p>- {payment.utbetalingsstatus}</p>
                        </lightning-layout>
                        <p if:false={payment.utbetalingsdato}>{payment.utbetalingsstatus}</p>
                    </lightning-layout-item>
                    <lightning-layout-item size="4" padding="horizontal-small">
                        <lightning-layout if:true={payment.forfallsdato} horizontal-align="end">
                            <p>{labels.PAYMENT_DUE_DATE}:</p>
                            &nbsp;
                            <lightning-formatted-date-time value={payment.forfallsdato}></lightning-formatted-date-time>
                        </lightning-layout>
                    </lightning-layout-item>
                    <lightning-layout-item if:false={multipleYtelser} size="12" padding="horizontal-small">
                        <template for:each={payment.ytelseListe} for:item="ytelse">
                            <b key={ytelse.ytelsestype}
                                ><lightning-formatted-date-time
                                    year="numeric"
                                    month="2-digit"
                                    day="2-digit"
                                    value={ytelse.ytelsesperiode.fom}
                                    key={ytelse.ytelsestype}
                                ></lightning-formatted-date-time>
                                &nbsp; - &nbsp;
                                <lightning-formatted-date-time
                                    year="numeric"
                                    month="2-digit"
                                    day="2-digit"
                                    value={ytelse.ytelsesperiode.tom}
                                    key={ytelse.ytelsestype}
                                ></lightning-formatted-date-time
                            ></b>
                        </template>
                    </lightning-layout-item>
                    <lightning-layout-item size="12" padding="horizontal-small">
                        <lightning-layout
                            class="slds-float_right"
                            type="button"
                            alternative-text={detailText}
                            aria-expanded={expanded}
                        >
                            <button class="slds-button chevron-toggle">
                                {detailText}<lightning-icon
                                    icon-name={chevronIcon}
                                    size="x-small"
                                    class="slds-button__icon slds-button__icon_right chevron-toggle"
                                ></lightning-icon>
                            </button>
                        </lightning-layout>
                    </lightning-layout-item>
                </lightning-layout>
            </lightning-layout-item>
            <!--PAYMENT DETAILS-->
            <lightning-layout-item if:true={expanded} size="12">
                <lightning-layout multiple-rows="true" class="slds-var-m-bottom_small">
                    <lightning-layout-item size="12" padding="horizontal-small">
                        <b>{labels.PAYMENT_RECIPIENT}</b> {payment.utbetaltTil.navn}
                    </lightning-layout-item>
                    <lightning-layout-item size="12" padding="horizontal-small" if:true={payment.utbetaltTilKonto}>
                        <b>{labels.BANK_ACCOUNT_NUMBER}</b> {payment.utbetaltTilKonto.kontonummer}
                    </lightning-layout-item>
                    <lightning-layout-item size="12" padding="horizontal-small" if:true={payment.utbetalingsmelding}>
                        <b>{labels.PAYMENT_MESSAGE}</b> {payment.utbetalingsmelding}
                    </lightning-layout-item>
                </lightning-layout>
                <template for:each={payment.ytelseListe} for:item="ytelse">
                    <c-nks-payment-details
                        key={ytelse.ytelsestype}
                        ytelse={ytelse}
                        display-header={multipleYtelser}
                        labels={labels}
                    ></c-nks-payment-details>
                </template>
            </lightning-layout-item>
        </lightning-layout>
    </div>
</template>
