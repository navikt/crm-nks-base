<template>
    <lightning-card>
        <!-- CARD BODY -->
        <lightning-layout>
            <!-- SAF Available theme vertical navigation list -->
            <lightning-layout-item padding="around-small" size="2">
                <c-nks-saf-vertical-navigation
                    onnewselection={handleNewSelection}
                    viewed-object-api-name={viewedObjectApiName}
                    viewed-record-id={viewedRecordId}
                    bruker-id-field={brukerIdField}
                    theme-group-field={themeGroupField}
                    relationship-field={relationshipField}
                    onsetavailablethemes={handleAvailableThemes}
                    onselectcase={handleSelectCase}
                    onselecttheme={handleSelectTheme}
                >
                </c-nks-saf-vertical-navigation>
            </lightning-layout-item>

            <!-- CONTENT -->
            <lightning-layout-item padding="around-small" size="10">
                <lightning-layout multiple-rows="true">
                    <!-- FILTER -->
                    <lightning-layout-item size="12">
                        <div class="slds-form-element" title="Journalpost filter">
                            <lightning-layout>
                                <lightning-layout-item>
                                    <lightning-input
                                        type="checkbox"
                                        label="Inngående"
                                        name="I"
                                        class="journalpostType"
                                        checked
                                        onchange={handleJournalpostTypeCheckboxChange}
                                    >
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item>
                                    <lightning-input
                                        type="checkbox"
                                        label="Utgående"
                                        name="U"
                                        class="journalpostType"
                                        checked
                                        onchange={handleJournalpostTypeCheckboxChange}
                                    >
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item>
                                    <lightning-input
                                        type="checkbox"
                                        label="Notat"
                                        name="N"
                                        class="journalpostType"
                                        checked
                                        onchange={handleJournalpostTypeCheckboxChange}
                                    >
                                    </lightning-input>
                                </lightning-layout-item>
                                <lightning-layout-item flexibility="no-grow" alignment-bump="left">
                                    <lightning-layout>
                                        <lightning-layout-item>
                                            <lightning-input
                                                type="date"
                                                label="Fra"
                                                value={fromDate}
                                                variant="label-inline"
                                                onchange={handleJournalpostFromDateChange}
                                            ></lightning-input>
                                        </lightning-layout-item>
                                        <lightning-layout-item>
                                            <lightning-input
                                                type="date"
                                                label="Til"
                                                value={toDate}
                                                variant="label-inline"
                                                onchange={handleJournalpostToDateChange}
                                            ></lightning-input>
                                        </lightning-layout-item>
                                    </lightning-layout>
                                </lightning-layout-item>
                            </lightning-layout>
                        </div>
                    </lightning-layout-item>
                    <lightning-layout-item padding="around-small" size="12">
                        <div title="Journalpost liste">
                            <!-- SPINNER -->
                            <template if:false={isLoaded}>
                                <lightning-spinner
                                    alternative-text="Loading"
                                    size="medium"
                                ></lightning-spinner>
                            </template>

                            <template if:true={isLoaded}>
                                <!-- ERROR MESSAGE -->
                                <template if:true={hasErrors}>
                                    <div class="slds-text-color_error slds-p-left_x-small">
                                        <p>
                                            <lightning-icon
                                                alternative-text="Feilmelding"
                                                icon-name="utility:error"
                                                size="xx-small"
                                                variant="error"
                                            >
                                            </lightning-icon>
                                            &nbsp;En feil har oppstått og journalpostene kan ikke
                                            hentes.
                                        </p>
                                        <ul class="slds-list_dotted">
                                            <template for:each={errors} for:item="error">
                                                <li key={error}>{error}</li>
                                            </template>
                                        </ul>
                                    </div>
                                </template>

                                <!-- EMPTY RESULT -->
                                <template if:true={isEmptyResult}>
                                    <p>Kunne ikke finne noen journalposter.</p>
                                </template>

                                <!-- LIST OF JOURNALPOSTS -->
                                <template if:false={isEmptyResult}>
                                    <ul class="slds-has-dividers_top">
                                        <template
                                            for:each={filteredJournalPosts}
                                            for:item="journalpost"
                                        >
                                            <li class="slds-item" key={journalpost.journalpostId}>
                                                <c-nks-saf-journalpost
                                                    journalpost={journalpost}
                                                ></c-nks-saf-journalpost>
                                            </li>
                                        </template>
                                    </ul>
                                </template>
                            </template>
                        </div>
                    </lightning-layout-item>
                    <lightning-layout-item padding="around-small" size="12">
                        <div class="slds-box slds-theme_shade">
                            <p>Dokumenter kan kun vises fra og med 4.juni 2016.</p>
                        </div>
                    </lightning-layout-item>
                </lightning-layout>
            </lightning-layout-item>
        </lightning-layout>

        <!-- CARD FOOTER -->
        <p slot="footer">
            <template if:true={isLoadingMore}>
                <div class="slds-is-relative">
                    Last flere
                    <lightning-spinner alternative-text="Loading" size="small"></lightning-spinner>
                </div>
            </template>
            <template if:false={isLoadingMore}>
                <template if:true={canLoadMore}>
                    <a onclick={queryMoreJournalPosts}>Last flere</a>
                </template>
            </template>
        </p>
    </lightning-card>
</template>
